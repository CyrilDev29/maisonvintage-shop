{% extends 'base.html.twig' %}
{% block title %}Changer mon mot de passe{% endblock %}
{% block body %}
    <div class="container" style="max-width:720px;margin:2rem auto;">
        <h1 class="h4 mb-3">Changer mon mot de passe</h1>

        {# r√©cup√®re les 2 vrais champs du RepeatedType #}
        {% set first  = form.plainPassword.first %}
        {% set second = form.plainPassword.second %}

        {{ form_start(form) }}

        <div class="mb-3">
            {{ form_label(first) }}
            <div class="input-group">
                {# on laisse Symfony g√©n√©rer l'id, on ajoute juste autocomplete/minlength/classes #}
                {{ form_widget(first, { attr: { autocomplete: 'new-password', minlength: 8, class: 'form-control' } }) }}
                <button type="button"
                        class="btn btn-outline-secondary pwd-toggle"
                        data-target="{{ first.vars.id }}"
                        aria-label="Afficher/masquer">
                    üëÅ
                </button>
            </div>
            {{ form_help(first) }}
            {{ form_errors(first) }}
        </div>

        <div class="mb-3">
            {{ form_label(second) }}
            <div class="input-group">
                {{ form_widget(second, { attr: { autocomplete: 'new-password', minlength: 8, class: 'form-control' } }) }}
                <button type="button"
                        class="btn btn-outline-secondary pwd-toggle"
                        data-target="{{ second.vars.id }}"
                        aria-label="Afficher/masquer la confirmation">
                    üëÅ
                </button>
            </div>
            {{ form_errors(second) }}
        </div>

        <button class="btn btn-primary">Enregistrer</button>
        <a class="btn btn-outline-secondary" href="{{ path('app_account') }}">Retour</a>

        {{ form_end(form) }}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.pwd-toggle').forEach(function (btn) {
                btn.addEventListener('click', function () {
                    const input = document.getElementById(btn.dataset.target);
                    if (!input) return;
                    input.type = (input.type === 'password') ? 'text' : 'password';
                });
            });
        });
    </script>
{% endblock %}
